{% extends "layout.html" %}

{% block body %}
    {% for email in search_items["emails"] %}
        <p>email: {{ email }}</p>
    {% endfor %}

    {% for username in search_items["usernames"] %}
        <p>username: {{ username }}</p>
    {% endfor %}

    {{ data }}
    
    <div class="position-absolute top-50 start-50 translate-middle">
        <div class="d-flex flex-wrap gap-3 justify-content-center">
            <div class="card fixed-card">
                <div class="card-header bg-info">IPinfo.io</div>
                <div class="card-body" id="ip_info">Loading</div>
                <div class="card-footer"><button class="btn btn-danger">Reload</button></div>
            </div>
        </div>
    </div>

    <script>
        function loadData(endpoint, element, format){
            fetch(endpoint)
                .then(d => d.json())
                .then(data => {
                    document.getElementById(element).innerHTML = format(data);
                })
                .catch(() => {
                   document.getElementById(element).innerHTML = "Failed to load"; 
                });
        }

        loadData("/api/ip_info", "ip_info", d => `${d.ip} ${d.city}`)
    </script>
{% endblock %}